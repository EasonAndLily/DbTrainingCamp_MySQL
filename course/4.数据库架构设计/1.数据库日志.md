# 数据库日志

![mysql-log-file](https://tva1.sinaimg.cn/large/008i3skNgy1grybnakxzaj30p00dw0th.jpg)

MySQL的二进制日志是构建高可用架构的基础，是实现数据库恢复或主从复制的必要手段，所以了解MySQL的二进制日志备份策略是深入学习MySQL必走之路，今天我们就来深入学习它！

MySQL日志可以分为很多种，前面我们说过的`Redo Log`和`Undo Log`日志属于MySQL存储引擎层的日志，而我们今天学习的`二进制日志`、`慢查日志`、`通用日志`等属于MySQL服务层日志，与具体的存储引擎无关，属于MySQL自身的日志，我们今天着重来了解这种日志。

MySQL的二进制日志（binary log）是一个二进制文件，主要用于记录修改数据或有可能引起数据变更的MySQL语句。二进制日志（binary log）中记录了对MySQL数据库执行更改的所有操作，并且记录了语句发生时间、执行时长、操作数据等其它额外信息，但是它不记录SELECT、SHOW等那些不修改数据的SQL语句。

通常来看，MySQL二进制日志格式通常分为两种：

## 基于段的日志格式
基于段的格式：binlog_format=STATEMENT, 这种格式记录的是MySQL执行过的SQL语句。

这种日志格式具有以下优点：
* 由于记录是SQL语句，所以日志积累量相对较少，能够磁盘及网络I/O.
* 这种日志格式对于数据库备份来说历史悠久，成熟度较高，bug较少，是比较稳定的方案。

但是，这种日志的缺点也比较明显：
* 必须要记录上下文信息才能保证语句在从服务器上执行结果和在主服务器上面相同。
* 一些特定的函数如UUID(),user()等这样非确定性的函数还是无法复制，所有有可能造成主备服务器数据不一致。



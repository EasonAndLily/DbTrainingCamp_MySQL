# 检索数据

![sql-select](https://tva1.sinaimg.cn/large/008i3skNgy1gr7j28rxr0j30go09q40b.jpg)

### 基本检索数据
如果想查看一个表里的数据，怎么办？当然是需要查询操作了，基本语法：

* 检索表里的所有列：
  ```sql
  SELECT * FROM [table_name];
  ```

* 检索表里的多个列：
  ```sql
  SELECT column1, column2, ... FROM [table_name]; 
  ```

* 检索结果消除重复：
  ```sql
  SELECT DISTINCT column1, column2,... FROM [table_name];
  ```

* 检索指定开始行(m)后和返回的行数(n)：
  ```sql
  SELECT column1, column2, ... FROM [table_name] LIMIT m, n; 
  ```

**说明：**
* 用*来查询所有列的性能比查询指定列的性能低，推荐用查询指定列的方式查询。
* 用LIMIT可以实现分页。

**举个例子：**

* 查询学生表里的所有记录：
  ```sql
  mysql> SELECT * FROM student_info;
  +----+--------+-----+-----+
  | id | name   | age | sex |
  +----+--------+-----+-----+
  |  1 | 小明   |  18 | 男  |
  |  2 | 李四   |  20 | 女  |
  |  3 | 王五   |  30 | 男  |
  +----+--------+-----+-----+
  3 rows in set (0.00 sec)
  ```

* 查询学生表里从第一行后开始的两条记录：
  ```sql
  mysql> SELECT * FROM student_info LIMIT 1, 2;
  +----+--------+-----+-----+
  | id | name   | age | sex |
  +----+--------+-----+-----+
  |  2 | 李四   |  20 | 女  |
  |  3 | 王五   |  30 | 男  |
  +----+--------+-----+-----+
  2 rows in set (0.00 sec)
  ```
参考链接：[SQL SELECT Statement](https://www.w3schools.com/sql/sql_select.asp)

### 过滤数据
我们检索数据，一般不会查询所有的数据，而是查询符合条件的数据，这就涉及到过滤数据了，语法是：

```sql
SELECT [*|columns] FROM [table_name] WHERE [condition expression];
```

**条件表达式有以下几种：**
#### 1. 条件操作符：

条件操作符是WHERE子句根据条件过滤数据的根本，常见的条件操作符有下面几种：

|    操作符     |        说明        |
| :-----------: | :----------------: |
|       =       |        等于        |
|      <>       |       不等于       |
|      !=       |       不等于       |
|       <       |        小于        |
|      <=       |      小于等于      |
|       >       |        大于        |
|      >=       |      大于等于      |
|    BETWEEN    | 在指定的两个值之间 |
| IS [NOT] NULL |    为空/不为空     |

**说明：**
* 是否为空判断用IS [NOT] NULL，与!=''是不同的含义，前者是数值本身是空，后者表示字符串为''，不要混淆。
* 他们之间的优先级和JAVA等语言里面的优先级一致，这里不再赘述。

**举个例子：** 查找学生表中年龄大于18岁的学生：
```sql
mysql> SELECT * FROM student_info WHERE age > 18;
+----+--------+-----+-----+
| id | name   | age | sex |
+----+--------+-----+-----+
|  2 | 李四   |  20 | 女  |
|  3 | 王五   |  30 | 男  |
+----+--------+-----+-----+
2 rows in set (0.05 sec)
```

#### 2. 逻辑操作符

如果想查找学生表中年龄大于18岁的男性学生，怎么办？这里就要用到逻辑操作符了，常见的有下面几种：
* **AND**：与操作符，用在WHERE子句中的关键字，用来指示检索满足所有给定的条件的行。
* **OR**：或操作符，用来指示检索匹配任一给定的行。
* **NOT**：非操作符，该操作符有且只有一个功能，那就是否定它之后所跟任何条件。

**上面的例子：** 查找学生表中年龄大于18岁的男性学生

```sql
mysql> SELECT * FROM student_info WHERE age > 18 AND sex = '男';
+----+--------+-----+-----+
| id | name   | age | sex |
+----+--------+-----+-----+
|  3 | 王五   |  30 | 男  |
+----+--------+-----+-----+
1 row in set (0.01 sec)
```

#### 3. 其他操作符：

除了上面的两种操作符之外，还有几种操作符比较常用：
* **IN操作符：**
IN操作符用来指定条件范围，范围中的每个条件都可以匹配，具体语法就是取值清单包括在括号里面：
  ```sql
  SELECT * FROM [table_name] WHERE column_name IN (value1, value2, value3,....);
  ```

  **例如：** 查找年龄为20岁和30岁的学生：
  ```sql
  mysql> SELECT * FROM student_info WHERE age IN (20, 30);
  +----+--------+-----+-----+
  | id | name   | age | sex |
  +----+--------+-----+-----+
  |  2 | 李四   |  20 | 女  |
  |  3 | 王五   |  30 | 男  |
  +----+--------+-----+-----+
  2 rows in set (0.00 sec)
  ```
* **LIKE操作符：** 
假如想获取学生表中名字里面带有‘王’字的学生，怎么办？这就要用到LIKE操作符了：

  ```sql
  SELECT * FROM [table_name] WHERE [column_name] LIKE 'value';
  ```
LIKE关键字后面经常有两种通配符：
  * **百分号(%)**: 表示任何字符出现任意次数，可以匹配一个或者多个。  
  * **下划线(_)**: 匹配任意字符，只能匹配单个字符。

  **例如：** 学生表里面有两个姓王的学生：王五和王明刚，如果用百分号和下划线匹配，则为：

  ```sql
  mysql> SELECT * FROM student_info WHERE name LIKE '王%';
  +----+-----------+-----+-----+
  | id | name      | age | sex |
  +----+-----------+-----+-----+
  |  3 | 王五      |  30 | 男  |
  |  4 | 王明刚    |  40 | 男  |
  +----+-----------+-----+-----+
  2 rows in set (0.00 sec)
  
  mysql> SELECT * FROM student_info WHERE name LIKE '王_';
  +----+--------+-----+-----+
  | id | name   | age | sex |
  +----+--------+-----+-----+
  |  3 | 王五   |  30 | 男  |
  +----+--------+-----+-----+
  1 row in set (0.00 sec)
  ```

**备注：**
正如所见，MySQL的通配符很有用，但这种功能是有代价的：通配符搜索的处理一般要比前面讨论的其他搜索花更长时间。这里给出一些使用通配符的要领：

* 不要过度使用通配符，如果其他操作符能够达到同样的目的，应该使用其他操作符。
* 在确实需要使用通配符时，除非有绝对必要，否则不要把他们用在搜索模式的开始处。
* 仔细注意通配符的位置，如果放错地方，可能不会返回想要的数据。

参考链接:

* [SQL WHERE Clause](https://www.w3schools.com/sql/sql_where.asp)
* [SQL AND, OR and NOT Operators](https://www.w3schools.com/sql/sql_and_or.asp)

### 排序检索
排序是我们经常需要用到的功能，比如学生成绩的排名，年龄的排名等，语法如下：

```sql
SELECT * FROM [table_name] ORDER BY [column_name] [ASC|DESC];
```

**说明：**
* ASC表示升序，可以省略，DESC表示降序，不可省略。
* 如果要对多个字段进行排序，可以在ORDER BY后面依次增加多个列，会依次按照多个列进行排序。
* 排序可以和LIMIT关键字进行组合来找到一个列中最高或者最低的值。
* 排序通常位于WHERE子句的后面。

**举个例子：** 查找学生表中年龄最大的男生：
```sql
mysql> SELECT * FROM student_info WHERE sex = '男' ORDER BY age DESC LIMIT 1; 
+----+-----------+-----+-----+
| id | name      | age | sex |
+----+-----------+-----+-----+
|  4 | 王明刚    |  40 | 男  |
+----+-----------+-----+-----+
1 row in set (0.01 sec)
```
参考链接：[SQL ORDER BY Keyword](https://www.w3schools.com/sql/sql_orderby.asp)